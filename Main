import telebot
import random

TOKEN = ''

bot = telebot.TeleBot(TOKEN) 


keyboard = telebot.types.InlineKeyboardMarkup()

button_1 = telebot.types.InlineKeyboardButton('/guessnumber', callback_data='guess_num')
button_2 = telebot.types.InlineKeyboardButton('/calculate', callback_data='calculate')
button_3 = telebot.types.InlineKeyboardButton('/generatepassword', callback_data='gen_password')
keyboard.add(button_1, button_2, button_3)

@bot.message_handler(commands=['start'])
def handle_command_start(message):
    bot.send_message(message.chat.id, "Привет меня зовут LikeBot!")

@bot.message_handler(commands=['help'])
def handle_command_help(message):
    bot.send_message(message.chat.id, "Все написанно в команде /start ")

@bot.callback_query_handler(func=lambda callback: True)
def handle_callback(callback):
    if callback.data == 'gen_password':
        global chars , n
        password = ''
        n = random.randint(10,15)
        for i in range(n):
            password += random.choice(chars)
        bot.send_message(callback.message.chat.id, f"Вот Ваш пороль: {password}")

    if callback.data == 'calculate':
        global start_calculate
        start_calculate = True
        bot.send_message(callback.message.chat.id, "Введите свой пример")
        bot.register_next_step_handler(callback.message, calculate)
    

def calculate(message):
    global start_calculate
    if start_calculate == True:
        bot.send_message(message.chat.id, f'Ответ: {eval(message.text)}')
        start_calculate = False

@bot.message_handler(commands=['guessnumber'])  
def handle_command_guessnumber(message):
    global start_game, a
    start_game = True
    a = random.randint(1,1000)
    bot.send_message(message.chat.id, "Я загадал число от 1 до 1000")
    bot.register_next_step_handler(message, guessnumber)


def guessnumber(message):
    global start_game
    if start_game == True:
        if int(message.text) != a:
            if int(message.text) > a:
                bot.send_message(message.chat.id, "Ваше число больше моего")
            if int(message.text) < a:
                bot.send_message(message.chat.id, "Ваше число меньше моего")
            
            bot.register_next_step_handler(message, guessnumber)
        else:
            bot.send_message(message.chat.id, "Вы угадали!")
            start_game = False

print('Сервер запущен.')

bot.polling(
    non_stop=True, 
    interval=1
)
   
